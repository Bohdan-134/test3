let doorSales = document.querySelectorAll(".door__sales"),
    doorWrapper = document.querySelector(".door__wrapper"),
    spinResultWrapper = document.querySelector(".spin-result-wrapper"),
    spinResultBtn = document.querySelector(".pop-up-button"),
    orderBlock = document.querySelector(".order_block");
    doorSale1 = document.getElementById("door__sales1"),
    doorSale2 = document.getElementById("door__sales2"),
    doorSale3 = document.getElementById("door__sales3"),
    customTitle = "";


document.addEventListener('DOMContentLoaded', () => {
    const doors = document.querySelectorAll(".door");
    const salesElements = document.querySelectorAll(".door__sales");
    const spinResultWrapper = document.querySelector(".spin-result-wrapper");
    const doorWrapper = document.querySelector(".door__wrapper");
    const orderBlock = document.querySelector(".order_block");

    doors.forEach(door => {
        door.addEventListener('click', (event) => openDoor(event, door));
    });

    function openDoor(event, door) {
        if (document.querySelectorAll('.open').length) {
            return
        }

        const doorParts = door.parentNode.querySelectorAll('.half');

        door.classList.add('open');
        if (doorParts.length > 0) {
            doorParts.forEach(part => part.classList.add('open'));
        }
        showDiscounts(door);
        setTimeout(() => {
            openOtherDoors(door);
        }, 1500);
    }

    function openOtherDoors(excludedDoor) {
        doors.forEach(otherDoor => {
            if (otherDoor !== excludedDoor) {
                otherDoor.classList.add('open');
                const otherDoorParts = otherDoor.querySelectorAll('.door__part');
                otherDoorParts.forEach(part => part.classList.add('open'));
            }
        });
        setTimeout(showResultWindow, 1500);
        setTimeout(showForm, 3000);
    }

    function showResultWindow() {
        spinResultWrapper.style.display = 'block';
    }

    function showForm() {
        doorWrapper.style.display = 'none';
        orderBlock.style.display = 'block';
    }

    function showDiscounts(openedDoor) {
        let discountValues = ['25%', '50%'];
        let shuffledDiscounts = shuffle(discountValues);
        salesElements.forEach((element, index) => {

            if (openedDoor.parentNode.contains(element)) {
                element.textContent = '100%';
            } else {
                element.textContent = shuffledDiscounts[index] || '0%';
            }
        });
    }

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            let j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }
});
function showResultWindow() {
    setTimeout(function () {
        $(".spin-result-wrapper").css("display", "block")
    }, 2000)
}

function showForm() {
    setTimeout(function () {
        $(".door__wrapper").slideUp(), $(".order_block").slideDown(), start_timer()
    }, 4000)
}

var resultWrapper = document.querySelector(".spin-result-wrapper"),
    wheel = document.querySelector(".wheel-img");
$(function () {
    $("a[href^='#']").click(function () {
        let e = $(this).attr("href");
        return document.getElementById(e.slice(1)) || (e = "#order_form"), $("html, body").animate({
            scrollTop: $(e).offset().top + "px"
        }), !1
    })
}), $(".close-popup, .pop-up-button").click(function (e) {
    e.preventDefault(), $(".spin-result-wrapper").fadeOut();
    let o = $("#roulette");
    e = (o = o || $("#order_form")).offset().top, $("body,html").animate({
        scrollTop: e
    }, 800)
});





